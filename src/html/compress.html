<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" type="text/css" href="../css/reset.css" />
    <title>web图片压缩</title>
</head>
<style>
    img {
        margin-top: 5%;
        max-width: 100%;
    }

    .link {
        margin-top: 5%;
        width: 90%;
        margin-left: 5%;
        height: 30px;
        color: #fff;
        text-align: center;
        display: block;
        -webkit-border-radius: 3px;
        -moz-border-radius: 3px;
        border-radius: 3px;
        background: #000;
        text-decoration: none;
        line-height: 30px;
    }
</style>

<body>
    <img src="https://raw.githubusercontent.com/fengyuanchen/cropperjs/master/docs/images/picture.jpg">

    <div style="margin: 5% 0px">设置压缩等级：
        <input style="text-align: center" type="number" id="input" value="40">（1~99）等级越小图片质量越小</div>
    设置宽高：
    <input id="kuan" style="margin-left:10px;width: 30%" type="number" value="100">
    <input id="gao" style="margin-left:10px;width: 30%" type="number" value="100">

    <div class="link" onclick="getThumb()">压缩(智能缩减尺寸)</div>
    <div class="link" onclick="getThumb2()">压缩(原图尺寸)</div>
    <div class="link" onclick="getThumb(true)">按比例压缩</div>
    <div class="link" onclick="batchThumb()">批量压缩</div>

    <img src="" id="result">
    <div id="batch"></div>

    <a id="download" class="link" style="margin-bottom: 5%" download="thumb.jpeg" href="">下载图片</a>
</body>
<script data-main="../js/main" src="../js/lib/require.js"></script>
<script>
    var result = document.getElementById('result')
    var download = document.getElementById('download')
    var batch = document.getElementById('batch')
    function getThumb(scale) {
        var input = document.getElementById('input').value
        $compress({
            src: 'https://raw.githubusercontent.com/fengyuanchen/cropperjs/master/docs/images/picture.jpg',
            width: scale ? document.getElementById('kuan').value : null,
            height: scale ? document.getElementById('gao').value : null,
            quality: input,
            ok: function (base64) {
                result.src = base64
            }
        })
    }
    function getThumb2() {
        var input = document.getElementById('input').value
        $compress({
            src: 'https://raw.githubusercontent.com/fengyuanchen/cropperjs/master/docs/images/picture.jpg',
            quality: input,
            original: true,
            ok: function (base64) {
                result.src = base64
            }
        })
    }
    function batchThumb() {
        var input = document.getElementById('input').value
        var arr = [
            'https://raw.githubusercontent.com/fengyuanchen/cropperjs/master/docs/images/picture.jpg',
            'https://raw.githubusercontent.com/fengyuanchen/cropperjs/master/docs/images/picture.jpg',
            'https://raw.githubusercontent.com/fengyuanchen/cropperjs/master/docs/images/picture.jpg'
        ]
        $compress({
            src: arr,
            quality: input,
            ok: function (array) {
                batch.innerHTML = ''
                array.forEach(function (base64) {
                    var image = new Image()
                    image.src = base64
                    batch.appendChild(image);
                })
            }
        })
    }
</script>

</html>